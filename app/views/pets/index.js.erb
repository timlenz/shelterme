$('#pets').html('<%= j render("pets") %>');

$('div.btn-group[data-toggle-name]').each(function(){
  var group   = $(this);
  var form    = group.parents('form').eq(0);
  var name    = group.attr('data-toggle-name');
  var hidden  = $('input[name="' + name + '"]', form);
  var current_value;
  $('button', group).each(function(){
    var button = $(this);
    button.on('click', function(){
      current_value = hidden.val();
      // Set value of clicked element to hidden control
      hidden.val($(this).val());
      // Submit pet state changes on click for Managed Pets, Admin Pets views
      if($('#managed_pets, #pets').length) {
        $(this).parent().parent().find("input[type=submit]").click();
      };
      // Set cookie when pet state is changed
      if(name == 'pet[pet_state_id]') {
        $.cookie("pet_state_change", current_value, { expires: 1, path: '/' });
      };
    });
    if(button.val() == hidden.val()) {
      // Set clicked button to active
      button.addClass('active');
    };
  });
});

$("#pets .managedDelete a").click(function(){
	$("#deletePet").dialog('open');
	$(".ui-dialog button").last().focus();
	var active = $(this);
	deletePetLink	 = $.trim(active.attr("href"));
	var name	 = $.trim($(this).parent().parent().find(".name").text());
	var code	 = $.trim($(this).parent().parent().find(".adminCode").text());
	if (name.length) {
		$(".ui-dialog-title").text("Delete " + name + "?");
		$("#deletePet .name").text(name);
	} else {
		$(".ui-dialog-title").text("Delete " + code + "?");
		$("#deletePet .name").text(code);
	};
	return false;
});